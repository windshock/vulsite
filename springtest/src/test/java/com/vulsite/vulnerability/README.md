# A담당 취약점 테스트 가이드

## 테스트 대상 취약점

| No | 취약점 | 테스트 파일 | 프레임워크 |
|----|--------|-------------|------------|
| 1 | SQL Injection | `SqlInjectionTest.java` | JUnit + MockMvc |
| 2 | Stored XSS | `StoredXssTest.java` | JUnit + Playwright |
| 9 | IDOR (정보수정) | `IdorUserUpdateTest.java` | JUnit + MockMvc |
| 10 | IDOR (글삭제) | `IdorBoardDeleteTest.java` | JUnit + MockMvc |

---

## 사전 준비

### 1. Playwright 브라우저 설치 (최초 1회)

```bash
# Mac/Linux
./gradlew test --tests "com.vulsite.*" || true
npx playwright install chromium

# 또는 직접 설치
mvn exec:java -e -D exec.mainClass=com.microsoft.playwright.CLI -D exec.args="install chromium"
```

### 2. Gradle Wrapper 설정 (필요시)

```bash
gradle wrapper --gradle-version 7.6.1
```

---

## 테스트 실행

### 전체 취약점 테스트 실행

```bash
cd springtest
./gradlew test
```

### 개별 테스트 실행

```bash
# SQL Injection 테스트
./gradlew test --tests "com.vulsite.vulnerability.SqlInjectionTest"

# Stored XSS 테스트 (브라우저 필요)
./gradlew test --tests "com.vulsite.vulnerability.StoredXssTest"

# IDOR 정보수정 테스트
./gradlew test --tests "com.vulsite.vulnerability.IdorUserUpdateTest"

# IDOR 글삭제 테스트
./gradlew test --tests "com.vulsite.vulnerability.IdorBoardDeleteTest"
```

### 테스트 리포트 확인

```bash
# 테스트 실행 후 리포트 확인
open build/reports/tests/test/index.html  # Mac
start build/reports/tests/test/index.html  # Windows
```

---

## 테스트 시나리오

### #1 SQL Injection

| 테스트명 | 설명 | 예상 결과 |
|----------|------|-----------|
| 정상 로그인 | 올바른 계정으로 로그인 | 성공 |
| 잘못된 비밀번호 | 틀린 비밀번호로 로그인 | 실패 |
| `' OR '1'='1' --` | 인증 우회 페이로드 | **성공 (취약)** |
| `admin'--` | 관리자 계정 탈취 | **성공 (취약)** |

### #2 Stored XSS

| 테스트명 | 페이로드 | 예상 결과 |
|----------|----------|-----------|
| script 태그 | `<script>alert(1)</script>` | **실행됨 (취약)** |
| img onerror | `<img src=x onerror=alert(1)>` | **실행됨 (취약)** |
| 쿠키 탈취 | `<script>document.cookie</script>` | **탈취 가능 (취약)** |

### #9 IDOR (정보수정)

| 테스트명 | 설명 | 예상 결과 |
|----------|------|-----------|
| 자기 정보 수정 | 본인 userId로 수정 | 성공 |
| 타인 정보 수정 | 다른 userId로 수정 | **성공 (취약)** |
| 관리자 정보 수정 | 관리자 userId로 수정 | **성공 (취약)** |

### #10 IDOR (글삭제)

| 테스트명 | 설명 | 예상 결과 |
|----------|------|-----------|
| 자기 글 삭제 | 본인 글 삭제 | 성공 |
| 타인 글 삭제 | 다른 사용자 글 삭제 | **성공 (취약)** |
| 관리자 글 삭제 | 관리자 공지 삭제 | **성공 (취약)** |

---

## 환경 정보

- **Java**: 11+
- **Spring Boot**: 2.7.18
- **Test Framework**: JUnit 5 + MockMvc
- **Browser Testing**: Playwright 1.40.0
- **지원 OS**: Mac, Windows, Linux
